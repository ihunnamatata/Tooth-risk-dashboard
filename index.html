<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Tooth-by-Tooth Risk Dashboard</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <header>
    <h1>Tooth-by-Tooth Risk Dashboard</h1>
  </header>

  <nav>
    <a href="/advanced-portfolio/">Home</a>
    <a href="/advanced-portfolio/dental_ai_industry_roadmap.html">Roadmap</a>
    <a href="/advanced-portfolio/dissertation.html">Dissertation</a>
    <a href="https://github.com/ihunnamatata/Tooth-risk-dashboard" target="_blank">GitHub Repo</a>
  </nav>

  <main>
    <p style="text-align:center;">Hover or click on a tooth to view its AI risk score, GPT explanation, and suggested procedure.</p>

    <div class="arch-container">
      <img src="static/IMG_4366.png" alt="Dental Arch" class="dental-arch">

      <!-- Tooth markers with labels -->
      <div class="tooth-zone" style="top: 38%; left: 12%;" 
        data-tooth="3" 
        data-risk="85" 
        data-explanation="Large carious lesion detected. GPT Suggests: Composite restoration or crown.">
        <span class="tooth-label">3</span>
      </div>

      <div class="tooth-zone" style="top: 36%; left: 50%;" 
        data-tooth="8" 
        data-risk="30" 
        data-explanation="Mild demineralization. GPT Suggests: Fluoride therapy.">
        <span class="tooth-label">8</span>
      </div>

      <div class="tooth-zone" style="top: 39%; left: 85%;" 
        data-tooth="14" 
        data-risk="95" 
        data-explanation="Advanced decay. GPT Suggests: Root canal and full crown.">
        <span class="tooth-label">14</span>
      </div>
    </div>

    <div class="button-container">
      <button onclick="generateExplanation()">üß† GPT Explains Your Risks</button>
      <button onclick="downloadJSON()">üìÅ Export to Chart (JSON)</button>
    </div>

    <!-- Floating Modal -->
    <div id="floatingModal" class="modal hidden"></div>
  </main>

  <footer>
    &copy; 2025 Ihunna Amugo ‚Ä¢ Dental AI Dashboard Project
  </footer>

  <script>
    const toothZones = document.querySelectorAll('.tooth-zone');
    const modal = document.getElementById('floatingModal');
    const findings = [];

    toothZones.forEach(tooth => {
      tooth.addEventListener('click', (e) => {
        const id = tooth.dataset.tooth;
        const risk = tooth.dataset.risk;
        const explanation = tooth.dataset.explanation;

        modal.innerHTML = `<strong>Tooth ${id}</strong><br>Risk: ${risk}%<br>${explanation}`;
        modal.style.left = `${e.pageX + 15}px`;
        modal.style.top = `${e.pageY - 10}px`;
        modal.classList.remove('hidden');

        if (!findings.find(f => f.tooth === id)) {
          findings.push({ tooth: id, risk: risk, explanation: explanation });
        }
      });
    });

    document.addEventListener('click', (e) => {
      if (!e.target.closest('.tooth-zone')) {
        modal.classList.add('hidden');
      }
    });

    function generateExplanation() {
      if (findings.length === 0) {
        alert("Please click on a tooth to generate findings.");
      } else {
        alert("GPT Explanation activated!\n\n" + findings.map(f => `Tooth ${f.tooth}: ${f.explanation}`).join("\n\n"));
      }
    }

    function downloadJSON() {
      const blob = new Blob([JSON.stringify(findings, null, 2)], { type: "application/json" });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = "tooth_findings.json";
      link.click();
    }
  </script>
</body>
</html>